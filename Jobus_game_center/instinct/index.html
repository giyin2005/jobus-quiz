<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>ç›´è¦ºå¯¦é©—å®¤ - v6.1</title>

    <script async src="https://www.googletagmanager.com/gtag/js?id=G-LH8TP88B66"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-LH8TP88B66');
    </script>

    <link rel="apple-touch-icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAMAAAAKE/YAAAAAbFBMVEUAAAD///+ZmZlmZmZ/f3+BgYF2dnZ+fn6EhISJiYmDg4N6enqHh4eFhYV5eXmCgoJ8fHyGhoaIiIiKioqMjIyNjY2SkpKUlJSZmZmcnJygIKEhISEoKCgtLS0yMjI4ODg+Pj5AQEBERERISEhMU238AAAAI3RSTlMAAQIDBAUGBwgJCgsMDQ4PEBESExQVFhcYGRobHB0eHyAhIiMkKikAAAMnSURBVHic7drbctowEAZQoCS0hJa0pQ3//88tG1wM2JjY1kmZ5z45M54R2yuRLEu0AAAAAAAAAAAAAAAAAAAAAADwP70+f+x2u91x3z/s/j+9vT9+P9/eP3b//d7eX5/v2+18f979t3p9f72db7fL/bL7T/X6+nS53C/n23b3H+r19elyuZzO291/ps/X58v5fDrdtv/4K/14fT6fT6fLdvff6Mfr8/l4Ok/b/Rf6fH0+H4+n03b3H+jH6/PxeDxtd/+8Pl+fj8fD/r+P1+fj4bT9x+fz8XA4bneX6/VwOOz/+3g9HA6H/X9fD/v9dne5Xvf7/X53uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/XZ3uV73+/12d7le9/v9dne5Xvf7/Xb3/wUAAAAAAPw3fwE+37g/7t+e7gAAAABJRU5ErkJggg==">

    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Noto Sans TC', sans-serif; 
            -webkit-tap-highlight-color: transparent;
            background-color: #f3f4f6;
            background-image: radial-gradient(#e5e7eb 1px, transparent 1px);
            background-size: 20px 20px;
            height: 100dvh;
            width: 100vw;
        }
        
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        .slide-up { animation: slideUp 0.4s ease-out forwards; }
        .slide-in-right { animation: slideInRight 0.3s ease-out forwards; }
        .pulse-text { animation: pulseText 2s infinite; }
        .toast-enter { animation: toastEnter 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }
        .toast-exit { animation: toastExit 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards; }

        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideUp { from { transform: translateY(20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        @keyframes slideInRight { from { transform: translateX(20px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
        @keyframes pulseText { 0%, 100% { opacity: 1; transform: scale(1); } 50% { opacity: 0.7; transform: scale(0.98); } }
        @keyframes toastEnter { from { opacity: 0; transform: translateY(-20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes toastExit { from { opacity: 1; transform: translateY(0); } to { opacity: 0; transform: translateY(-20px); } }

        input[type=range] { touch-action: none; -webkit-appearance: none; width: 100%; background: transparent; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 48px; width: 48px; border-radius: 50%; background: #ffffff; cursor: pointer; border: 6px solid #4F46E5; box-shadow: 0 4px 12px rgba(79, 70, 229, 0.4); margin-top: -20px; position: relative; z-index: 20; }
        input[type=range]::-webkit-slider-runnable-track { width: 100%; height: 12px; cursor: pointer; background: transparent; border-radius: 10px; }
        
        .category-card:active { transform: scale(0.98); transition: transform 0.1s; }
    </style>
</head>
<body class="flex justify-center items-center overflow-hidden">

    <div id="app" class="w-full h-full sm:max-w-[420px] sm:h-auto sm:max-h-[90vh] bg-white relative sm:shadow-2xl flex flex-col overflow-hidden sm:rounded-[2.5rem] transition-all duration-300">
    </div>

    <div id="toast-container" class="fixed top-8 left-0 right-0 z-50 flex justify-center pointer-events-none"></div>

<script>
const WORKER_URL = "https://prediction-game-api.giyin2005.workers.dev/"; 

const DataService = {
    categories: {
        WORKPLACE: [
            { id: "wp_01", displayTitle: "é€™å€‹å°ˆæ¡ˆçœŸçš„æœƒæº–æ™‚ä¸Šç·šå—ï¼Ÿ", introText: "è€é—†èªª Q3 ä¸€å®šè¦ç™¼å¸ƒï¼Œä¾ä½ çš„ç¶“é©—ï¼Œé€™ä»¶äº‹æˆçœŸçš„æ©Ÿç‡æ˜¯ï¼Ÿ", marketType: "EVENT" },
            { id: "wp_02", displayTitle: "å…¬å¸å®£ä½ˆçš„ã€Œæ–°ç¦åˆ©æ”¿ç­–ã€æ˜å¹´é‚„æœƒåœ¨å—ï¼Ÿ", introText: "ä½ è¦ºå¾—é€™æ˜¯ä¸€å€‹é•·æœŸæ‰¿è«¾ï¼Œé‚„æ˜¯é›·è²å¤§é›¨é»å°ï¼Ÿ", marketType: "STABLE" },
            { id: "wp_03", displayTitle: "åŸæœ¬æ‰¿è«¾çš„æ–°åŠŸèƒ½ï¼Œå¹´åº•å‰çœŸçš„åšå¾—å®Œå—ï¼Ÿ", introText: "çœ‹è‘—ç¾åœ¨çš„é€²åº¦æ¢ï¼Œä½ è¦ºå¾—å·¥ç¨‹åœ˜éšŠèƒ½æº–æ™‚äº¤ä»˜å—ï¼Ÿ", marketType: "EVENT" },
            { id: "wp_04", displayTitle: "è¾¦å…¬å®¤é—œæ–¼ã€Œäººäº‹å‡çµã€çš„å‚³èæ˜¯çœŸçš„å—ï¼Ÿ", introText: "æ ¹æ“šä½ çš„è§€å¯Ÿï¼Œå…¬å¸ç›®å‰çš„äººåŠ›ç­–ç•¥å‚¾å‘æ˜¯ï¼Ÿ", marketType: "STABLE" },
            { id: "wp_05", displayTitle: "ä»Šå¹´çš„å¹´çµ‚çé‡‘ï¼Œæœƒæ¯”å»å¹´å¥½å—ï¼Ÿ", introText: "çœ‹è‘—è²¡å ±å’Œè€é—†çš„è‡‰è‰²ï¼Œä½ å¿ƒè£¡çš„é æœŸæ˜¯ï¼Ÿ", marketType: "STABLE" },
            { id: "wp_06", displayTitle: "é€™æ¬¡çš„å†—é•·æœƒè­°æœƒæº–æ™‚çµæŸå—ï¼Ÿ", introText: "è­°ç¨‹çœ‹èµ·ä¾†å¾ˆæ»¿ï¼Œä¸»è¬›äººåˆå¾ˆæ„›é›¢é¡Œï¼Œä½ çš„è†€èƒ±å‘Šè¨´ä½ ...", marketType: "EVENT" },
            { id: "wp_07", displayTitle: "æˆ‘çš„ææ¡ˆæœƒè¢«è€é—†æ¡ç´å—ï¼Ÿ", introText: "ä½ æº–å‚™äº†å¾ˆä¹…ï¼Œä½†çœ‹è€é—†ä»Šå¤©çš„è‡‰è‰²ï¼Œå‹ç®—æœ‰å¤šå°‘ï¼Ÿ", marketType: "VOLATILE" },
            { id: "wp_08", displayTitle: "éš”å£éƒ¨é–€çš„é‚£å€‹åŒäº‹æœƒé›¢è·å—ï¼Ÿ", introText: "è½èªªä»–æœ€è¿‘ä¸€ç›´åœ¨åˆ· LinkedInï¼Œä½ è¦ºå¾—ä»–çœŸçš„æœƒèµ°å—ï¼Ÿ", marketType: "EVENT" },
            { id: "wp_09", displayTitle: "å…¬å¸æœªä¾†æœƒå…¨é¢å–æ¶ˆé ç«¯å·¥ä½œå—ï¼Ÿ", introText: "ç§‘æŠ€å·¨é ­éƒ½å«äººå›è¾¦å…¬å®¤äº†ï¼Œæˆ‘å€‘å…¬å¸æœƒè·Ÿé¢¨å—ï¼Ÿ", marketType: "STABLE" },
            { id: "wp_10", displayTitle: "é€™å€‹å­£åº¦çš„ KPI ç›®æ¨™è¨­å¾—åˆç†å—ï¼Ÿ", introText: "çœ‹è‘—é‚£äº›æ•¸å­—ï¼Œä½ è¦ºå¾—æ˜¯æŒ‘æˆ°é‚„æ˜¯å¤©æ–¹å¤œè­šï¼Ÿ", marketType: "STABLE" },
            { id: "wp_11", displayTitle: "AI æœƒåœ¨ä¸‰å¹´å…§å–ä»£æˆ‘çš„è·ä½å—ï¼Ÿ", introText: "çœ‹è‘— AI å·¥å…·è¶Šä¾†è¶Šå¼·ï¼Œä½ å…§å¿ƒçš„å±æ©Ÿæ„ŸæŒ‡æ•¸æ˜¯ï¼Ÿ", marketType: "STABLE" },
            { id: "wp_12", displayTitle: "é€™æ¬¡çš„éƒ¨é–€èšé¤æ°£æ°›æœƒå¾ˆåƒµå—ï¼Ÿ", introText: "åˆè¦è·Ÿä¸ç†Ÿçš„åŒäº‹å°¬èŠï¼Œä½ è¦ºå¾—æœƒæœ‰å¤šå°·å°¬ï¼Ÿ", marketType: "VOLATILE" },
            { id: "wp_13", displayTitle: "è€é—†å£é ­æ‰¿è«¾çš„ã€Œè£œä¼‘ã€çœŸçš„ä¼‘å¾—åˆ°å—ï¼Ÿ", introText: "é‚„æ˜¯ç­‰åˆ°éæœŸäº†éƒ½é‚„åœ¨å¿™å°ˆæ¡ˆï¼Ÿ", marketType: "EVENT" },
            { id: "wp_14", displayTitle: "ç«¶çˆ­å°æ‰‹çš„æ–°ç”¢å“æœƒé‡æ“Šæˆ‘å€‘å—ï¼Ÿ", introText: "å¸‚å ´å‚³èä»–å€‘ä¾†å‹¢æ´¶æ´¶ï¼Œä½ å°è‡ªå®¶ç”¢å“é˜²ç¦¦åŠ›æœ‰ä¿¡å¿ƒå—ï¼Ÿ", marketType: "VOLATILE" },
            { id: "wp_15", displayTitle: "æˆ‘ä»Šå¹´æœ‰æ©Ÿæœƒå‡è·åŠ è–ªå—ï¼Ÿ", introText: "æ˜¯è«–è³‡æ’è¼©é‚„æ˜¯å¯¦åŠ›è‡³ä¸Šï¼Ÿä½ è¦ºå¾—ä½ çš„æ©Ÿæœƒå¤§å—ï¼Ÿ", marketType: "STABLE" }
        ],
        INVEST: [
            { id: "inv_01", displayTitle: "æ¯”ç‰¹å¹£çŸ­æœŸå…§æœƒå†å‰µæ­·å²æ–°é«˜å—ï¼Ÿ", introText: "å¸‚å ´æƒ…ç·’æ¥µåº¦è²ªå©ªï¼Œä½ çš„ç†æ€§å‘Šè¨´ä½ æœƒç™¼ç”Ÿå—ï¼Ÿ", marketType: "VOLATILE" },
            { id: "inv_02", displayTitle: "é€™å®¶å…¬å¸çš„è‚¡åƒ¹ï¼Œä¸‹å€‹æœˆæœƒå‰µæ–°é«˜å—ï¼Ÿ", introText: "æŠ€è¡“ç·šåœ–çœ‹èµ·ä¾†å¾ˆå¼·ï¼Œä½†ä½ çš„ç›´è¦ºæ•¢è¿½é«˜å—ï¼Ÿ", marketType: "VOLATILE" },
            { id: "inv_03", displayTitle: "ç¾åœ¨æ˜¯è²·é€²é»ƒé‡‘/é¿éšªè³‡ç”¢çš„å¥½æ™‚æ©Ÿå—ï¼Ÿ", introText: "å…¨çƒå±€å‹¢å‹•ç›ªï¼Œä½ è¦ºå¾—é¿éšªè³‡ç”¢é‚„æœƒç¹¼çºŒæ¼²å—ï¼Ÿ", marketType: "STABLE" },
            { id: "inv_04", displayTitle: "é€™å€‹ç†±é–€çš„è¿·å› å¹£ (Meme Coin) æœƒæ­¸é›¶å—ï¼Ÿ", introText: "é›–ç„¶ç¾åœ¨ç‚’å¾ˆå…‡ï¼Œä½†ä½ è¦ºå¾—å®ƒèƒ½æ´»éä¸‰å€‹æœˆå—ï¼Ÿ", marketType: "VOLATILE" },
            { id: "inv_05", displayTitle: "å¤®è¡Œçš„ä¸‹ä¸€æ­¥åˆ©ç‡æ±ºç­–æœƒå¦‚å¸‚å ´é æœŸå—ï¼Ÿ", introText: "é€šè†¨æ•¸æ“šå¥½å£åƒåŠï¼Œä½ è³­å¤®è¡Œæœƒæ€éº¼åšï¼Ÿ", marketType: "STABLE" },
            { id: "inv_06", displayTitle: "ç¾åœ¨é€²å ´è²·æˆ¿æ˜¯ç•¶æ¥ç›¤ä¿ å—ï¼Ÿ", introText: "æˆ¿åƒ¹å±…é«˜ä¸ä¸‹ï¼Œç¾åœ¨è²·æ˜¯å‰›éœ€é‚„æ˜¯éŸ­èœï¼Ÿ", marketType: "STABLE" },
            { id: "inv_07", displayTitle: "AI æ¦‚å¿µè‚¡çš„æ³¡æ²«è¿‘æœŸæœƒç ´å—ï¼Ÿ", introText: "é€™æ³¢æ¼²å‹¢å¤ªç˜‹ç‹‚ï¼Œæ˜¯æŠ€è¡“é©å‘½é‚„æ˜¯ç¶²è·¯æ³¡æ²« 2.0ï¼Ÿ", marketType: "VOLATILE" },
            { id: "inv_08", displayTitle: "ç¾åœ¨æ˜¯æ›å¤–å¹£/æ—¥å¹£çš„å¥½æ™‚æ©Ÿå—ï¼Ÿ", introText: "åŒ¯ç‡èµ·èµ·ä¼ä¼ï¼Œä½ è¦ºå¾—ç¾åœ¨æ˜¯ç›¸å°ä½é»å—ï¼Ÿ", marketType: "STABLE" },
            { id: "inv_09", displayTitle: "è‚¡å¸‚å¤§ç›¤çŸ­æœŸå…§æœƒå†å‰µé‡Œç¨‹ç¢‘å—ï¼Ÿ", introText: "ç¶“æ¿Ÿæˆé•· vs åœ°ç·£æ”¿æ²»ï¼Œä½ å°æœªä¾†å¤šæ¨‚è§€ï¼Ÿ", marketType: "STABLE" },
            { id: "inv_10", displayTitle: "é€™æª”æ–°ä¸Šå¸‚çš„ ETF æœƒç ´ç™¼å—ï¼Ÿ", introText: "å»£å‘Šæ‰“å¾ˆå¤§ï¼Œä½†æˆåˆ†è‚¡çœ‹èµ·ä¾†æœ‰é»è™›ï¼Ÿ", marketType: "EVENT" },
            { id: "inv_11", displayTitle: "åœ‹éš›æ²¹åƒ¹ä¸‹å€‹æœˆæœƒå¤§æ¼²å—ï¼Ÿ", introText: "ç”¢æ²¹åœ‹å±€å‹¢ç·Šå¼µï¼Œä½ çš„éŒ¢åŒ…æº–å‚™å¥½äº†å—ï¼Ÿ", marketType: "EVENT" },
            { id: "inv_12", displayTitle: "å¸‚å ´åäººçš„ç¤¾ç¾¤ç™¼è¨€æœƒå†æ¬¡é€ æˆéœ‡ç›ªå—ï¼Ÿ", introText: "ä»–å€‘çš„ä¸€å¥è©±ç¸½æ˜¯èƒ½è®“å¹£åœˆä¸Šä¸‹è·³å‹•ï¼Œä½ è¦ºå¾—å‘¢ï¼Ÿ", marketType: "VOLATILE" },
            { id: "inv_13", displayTitle: "ç¾åœ¨æŠŠå®šå­˜è§£ç´„å»è²·è‚¡ç¥¨æ˜æ™ºå—ï¼Ÿ", introText: "ä¿å®ˆèˆ‡è²ªå©ªçš„æ‹”æ²³ï¼Œä½ çš„ç›´è¦ºé¸å“ªé‚Šï¼Ÿ", marketType: "VOLATILE" },
            { id: "inv_14", displayTitle: "å…¨çƒç¶“æ¿Ÿæœƒå¯¦ç¾ã€Œè»Ÿè‘—é™¸ã€å—ï¼Ÿ", introText: "é€šè†¨ä¼¼ä¹å—æ§äº†ï¼Œä½†è¡°é€€çš„é™°å½±çœŸçš„æ¶ˆå¤±äº†å—ï¼Ÿ", marketType: "STABLE" },
            { id: "inv_15", displayTitle: "æœ‹å‹æ¨è–¦çš„ã€Œå…§ç·šæ˜ç‰Œã€èƒ½ä¿¡å—ï¼Ÿ", introText: "ä»–èªªç©©è³ºä¸è³ ï¼Œä½†ä½ çš„ç†æ™ºå‘Šè¨´ä½ ...", marketType: "VOLATILE" }
        ],
        LIFE: [
            { id: "life_01", displayTitle: "é€™å°æ˜æ˜Ÿæƒ…ä¾¶è¿‘æœŸæœƒåˆ†æ‰‹å—ï¼Ÿ", introText: "å…«å¦é›œèªŒéƒ½åœ¨å‚³ï¼Œçœ‹ä»–å€‘æœ€è¿‘çš„äº’å‹•ï¼Œä½ è¦ºå¾—å‘¢ï¼Ÿ", marketType: "EVENT" },
            { id: "life_02", displayTitle: "æ˜å¤©çš„å¤©æ°£çœŸçš„æœƒå¦‚é å ±ä¸€æ¨£ä¸‹é›¨å—ï¼Ÿ", introText: "çœ‹è‘—ç¾åœ¨çš„å¤©ç©ºï¼Œä½ è¦ºå¾—æ°£è±¡å±€æº–å—ï¼Ÿ", marketType: "EVENT" },
            { id: "life_03", displayTitle: "é€™éƒ¨æœŸå¾…å·²ä¹…çš„é›»å½±æœƒæ˜¯çˆ›ç‰‡å—ï¼Ÿ", introText: "é å‘Šç‰‡å‰ªå¾—å¾ˆå¥½ï¼Œä½†é€šå¸¸é€™å°±æ˜¯é›·ç‰‡çš„å¾µå…†ï¼Ÿ", marketType: "VOLATILE" },
            { id: "life_04", displayTitle: "ä½ æ”¯æŒçš„çƒéšŠä¸‹ä¸€å ´æœƒè´å—ï¼Ÿ", introText: "å°æ‰‹å¾ˆå¼·ï¼Œä½†ä½ çš„ä¿¡ä»°æœ‰å¤šå …å®šï¼Ÿ", marketType: "EVENT" },
            { id: "life_05", displayTitle: "ä¸‹é€±æ²¹åƒ¹æœƒä¸Šæ¼²å—ï¼Ÿ", introText: "åœ‹éš›å±€å‹¢ä¸ç©©ï¼Œä½ è¦ºå¾—è©²å…ˆå»åŠ æ²¹å—ï¼Ÿ", marketType: "STABLE" },
            { id: "life_06", displayTitle: "é€™å ´ç§’æ®ºç´šçš„æ¼”å”±æœƒï¼Œæˆ‘èƒ½æ¶åˆ°ç¥¨å—ï¼Ÿ", introText: "å¹¾åè¬äººåœ¨ç·šæ’éšŠï¼Œä½ è¦ºå¾—ä½ æ˜¯å¤©é¸ä¹‹äººå—ï¼Ÿ", marketType: "VOLATILE" },
            { id: "life_07", displayTitle: "é€™å€‹æœˆç«‹ä¸‹çš„æ¸›è‚¥ Flag æœƒæˆåŠŸå—ï¼Ÿ", introText: "çœ‹è‘—æ‰‹ä¸Šçš„çå¥¶ï¼Œä½ è¦ºå¾—é€™æ¬¡èƒ½ç˜¦å¹¾å…¬æ–¤ï¼Ÿ", marketType: "EVENT" },
            { id: "life_08", displayTitle: "ä¸‹ä¸€æ¬¡é¢±é¢¨ä¾†è¥²ï¼Œæœƒæ”¾é¢±é¢¨å‡å—ï¼Ÿ", introText: "è·¯å¾‘åœ–çœ‹èµ·ä¾†å¾ˆåƒï¼Œä½ æ•¢ä¸æ•¢ç¾åœ¨å°±è¨‚ KTVï¼Ÿ", marketType: "EVENT" },
            { id: "life_09", displayTitle: "æ›–æ˜§å°è±¡ç¨å¾Œæœƒå›æˆ‘è¨Šæ¯å—ï¼Ÿ", introText: "å·²ç¶“å·²è®€ä¸€å°æ™‚äº†ï¼Œä»–åœ¨å¿™é‚„æ˜¯æ²’èˆˆè¶£ï¼Ÿ", marketType: "VOLATILE" },
            { id: "life_10", displayTitle: "ä¸‹ä¸€æœŸçš„çµ±ä¸€ç™¼ç¥¨æœƒä¸­çå—ï¼Ÿ", introText: "ç´¯ç©äº†ä¸€å †ç´™æœ¬ï¼Œé€™æ¬¡è²¡ç¥çˆºæœƒçœ·é¡§å—ï¼Ÿ", marketType: "VOLATILE" },
            { id: "life_11", displayTitle: "é€™å®¶ç¶²ç´…é¤å»³çœŸçš„å¦‚å‚³èä¸­å¥½åƒå—ï¼Ÿ", introText: "æ’éšŠå…©å°æ™‚ï¼Œä½ è¦ºå¾—æœƒæ˜¯é›·åº—å—ï¼Ÿ", marketType: "EVENT" },
            { id: "life_12", displayTitle: "æ–°æ¬¾ iPhone æœƒæœ‰ä»¤äººé©šè‰·çš„æ”¹è®Šå—ï¼Ÿ", introText: "é‚„æ˜¯åˆåªæ˜¯æ›å€‹é¡è‰²ã€æ”¹å€‹æŒ‰éˆ•ï¼Ÿ", marketType: "STABLE" },
            { id: "life_13", displayTitle: "ä»Šå¤©ä¸Šç­é€šå‹¤æœƒå¡è»Šé²åˆ°å—ï¼Ÿ", introText: "çœ‹è‘—çª—å¤–çš„è·¯æ³ï¼Œä½ çš„ä¸ç¥¥é æ„Ÿæœ‰å¤šå¼·ï¼Ÿ", marketType: "EVENT" },
            { id: "life_14", displayTitle: "é‚£ä½ç¶²ç´…çš„é“æ­‰å½±ç‰‡æ˜¯çœŸå¿ƒçš„å—ï¼Ÿ", introText: "ç©¿è‘—ç´ Tç´ é¡ï¼Œä½ è¦ºå¾—ä»–åœ¨æ¼”æˆ²é‚„æ˜¯çœŸæ‚”éï¼Ÿ", marketType: "VOLATILE" },
            { id: "life_15", displayTitle: "æˆ‘ä¹Ÿèƒ½åƒç¶²è·¯ä¸Šé‚£æ¨£é å‰¯æ¥­æœˆå…¥åè¬å—ï¼Ÿ", introText: "çœ‹åˆ¥äººåšéƒ½å¾ˆç°¡å–®ï¼Œå¯¦éš›è·³ä¸‹å»åšå‘¢ï¼Ÿ", marketType: "STABLE" }
        ]
    },

    async fetchQuestions(categoryKey) {
        let pool = this.categories[categoryKey] || this.categories.WORKPLACE;
        const playedKey = `played_${categoryKey}`;
        let playedIds = JSON.parse(localStorage.getItem(playedKey) || "[]");
        let available = pool.filter(q => !playedIds.includes(q.id));

        if (available.length < 5) {
            localStorage.removeItem(playedKey);
            available = pool;
            playedIds = [];
        }

        const shuffled = available.sort(() => 0.5 - Math.random()).slice(0, 5);
        const newPlayedIds = [...playedIds, ...shuffled.map(q => q.id)];
        localStorage.setItem(playedKey, JSON.stringify(newPlayedIds));

        let marketPools = null;
        if (WORKER_URL) {
            try {
                const [res] = await Promise.all([
                    fetch(WORKER_URL),
                    new Promise(r => setTimeout(r, 1500)) 
                ]);
                if (res.ok) marketPools = await res.json();
            } catch (e) { console.warn("API Error", e); }
        }

        return shuffled.map(q => {
            let prob = 50;
            if (marketPools && marketPools[q.marketType] && marketPools[q.marketType].length > 0) {
                const p = marketPools[q.marketType];
                prob = p[Math.floor(Math.random() * p.length)];
            } else {
                if (q.marketType === "STABLE") prob = Math.floor(Math.random() * (70 - 30 + 1) + 30);
                else if (q.marketType === "VOLATILE") prob = Math.floor(Math.random() * (90 - 10 + 1) + 10);
                else prob = Math.floor(Math.random() * (85 - 15 + 1) + 15);
            }
            return { ...q, mockMarketProb: prob, categoryLabel: this.getCategoryLabel(categoryKey) };
        });
    },

    getCategoryLabel(key) {
        const map = { WORKPLACE: "è·å ´ç›´è¦º", INVEST: "æŠ•è³‡å‹ç‡", LIFE: "å‘½é‹è¼ªç›¤" };
        return map[key] || "æ¸¬é©—";
    }
};

class GameStore {
    constructor() {
        this.state = {
            view: 'home', questions: [], currentQIndex: 0, userGuess: 50, history: [],
            loadingText: 'æ­£åœ¨åŒæ­¥å¸‚å ´æ•¸æ“š...', selectedCategory: 'WORKPLACE',
            toastMessage: null, toastVisible: false
        };
        this.listeners = [];
        this.hasShownSliderHint = false; 
    }
    subscribe(listener) { this.listeners.push(listener); }
    setState(newState, silent = false) { this.state = { ...this.state, ...newState }; if (!silent) this.notify(); }
    notify() { this.listeners.forEach(fn => fn(this.state)); }

    showToast(msg, duration = 3000) {
        const container = document.getElementById('toast-container');
        const el = document.createElement('div');
        el.className = "bg-gray-800 text-white px-6 py-3 rounded-full shadow-lg text-sm font-bold tracking-wide toast-enter";
        el.innerText = msg;
        container.appendChild(el);
        setTimeout(() => {
            el.classList.remove('toast-enter');
            el.classList.add('toast-exit');
            setTimeout(() => el.remove(), 300);
        }, duration);
    }

    async selectCategory(category) {
        this.setState({ view: 'loading', selectedCategory: category, loadingText: 'æ­£åœ¨é€£ç·š Polymarket è³‡æ–™åº«...' });
        try {
            const data = await DataService.fetchQuestions(category);
            this.setState({ questions: data, view: 'game', currentQIndex: 0, history: [], userGuess: 50 });
            if(!localStorage.getItem('hasPlayed')) {
                setTimeout(() => this.showToast("æ²’æœ‰æ­£ç¢ºç­”æ¡ˆï¼Œåªçœ‹ä½ çš„ç¬¬ä¸€ç›´è¦º"), 500);
            }
        } catch (e) {
            console.error(e);
            alert("è¼‰å…¥å¤±æ•—ï¼Œè«‹æª¢æŸ¥ç¶²è·¯é€£ç·š");
            this.setState({ view: 'home' });
        }
    }

    startGame() { this.setState({ view: 'game', userGuess: 50 }); }
    
    updateGuess(val, silent = false) { 
        this.setState({ userGuess: parseInt(val) }, silent); 
        if (!this.hasShownSliderHint && !localStorage.getItem('hasPlayed')) {
            this.hasShownSliderHint = true;
            this.showToast("åœç•™å¤ªä¹…ï¼Œé€šå¸¸ä¸æ˜¯ç›´è¦º", 2500);
        }
    }

    submitGuess() {
        const { questions, currentQIndex, userGuess, history } = this.state;
        const currentQ = questions[currentQIndex];
        const record = { question: currentQ, user: userGuess, market: currentQ.mockMarketProb, diff: userGuess - currentQ.mockMarketProb };
        
        if(!localStorage.getItem('hasPlayed') && currentQIndex === 0) {
            this.showToast("ä½ çš„åˆ¤æ–·å·²è¢«è¨˜éŒ„");
        }
        
        this.setState({ history: [...history, record], view: 'reveal' });
    }

    nextQuestion() {
        const { currentQIndex, questions } = this.state;
        if (currentQIndex + 1 < questions.length) {
            this.setState({ currentQIndex: currentQIndex + 1, view: 'game', userGuess: 50 });
        } else {
            localStorage.setItem('hasPlayed', 'true'); 
            this.setState({ view: 'result' });
        }
    }
    goHome() { this.setState({ view: 'home' }); }
}
const store = new GameStore();

const App = document.getElementById('app');
function render(state) {
    App.innerHTML = ''; 
    switch(state.view) {
        case 'home':    App.innerHTML = ViewHome(); break;
        case 'loading': App.innerHTML = ViewLoading(state); break;
        case 'game':    App.innerHTML = ViewGame(state); break;
        case 'reveal':  App.innerHTML = ViewReveal(state); break;
        case 'result':  App.innerHTML = ViewResult(state); break;
    }
    bindEvents(state);
}

function bindEvents(state) {
    if (state.view === 'home') {
        document.getElementById('btn-cat-work').onclick = () => store.selectCategory('WORKPLACE');
        document.getElementById('btn-cat-invest').onclick = () => store.selectCategory('INVEST');
        document.getElementById('btn-cat-life').onclick = () => store.selectCategory('LIFE');
    }
    const slider = document.getElementById('guess-slider');
    if (slider) {
        slider.oninput = (e) => {
            const val = e.target.value;
            store.updateGuess(val, true); 
            const display = document.getElementById('val-display');
            const track = document.getElementById('track-fill');
            const thumb = document.getElementById('thumb-visual');
            if(display) display.innerHTML = `${val}<span class="text-3xl text-indigo-300 ml-1">%</span>`;
            if(track) track.style.width = `${val}%`;
            if(thumb) thumb.style.left = `${val}%`;
        };
    }
    const confirmBtn = document.getElementById('btn-confirm');
    if (confirmBtn) confirmBtn.onclick = () => store.submitGuess();
    const nextBtn = document.getElementById('btn-next');
    if (nextBtn) nextBtn.onclick = () => store.nextQuestion();
    const restartBtn = document.getElementById('btn-restart');
    if (restartBtn) restartBtn.onclick = () => store.goHome();
}

// --- Views (v6.1 Final) ---

function ViewHome() {
    return `
        <div class="flex flex-col h-full p-8 bg-white relative overflow-hidden fade-in">
            <div class="mt-8 mb-6 flex-shrink-0">
                <span class="inline-block px-3 py-1 bg-gray-900 text-white text-xs font-bold tracking-widest rounded-full mb-4">v6.1 æ­£å¼ç‰ˆ</span>
                <h1 class="text-5xl font-black text-gray-900 mb-2 leading-none">ç›´è¦º<br><span class="text-indigo-600">å¯¦é©—å®¤</span></h1>
                <p class="text-gray-500 text-lg font-medium mt-3 leading-relaxed">æŠŠä½ çš„ç›´è¦ºï¼Œæ”¾åˆ°ç¾¤é«”æ™ºæ…§è£¡å°ç…§ã€‚<br>é€™ä¸æ˜¯è€ƒè©¦ï¼Œè€Œæ˜¯çœ‹è¦‹è‡ªå·±åˆ¤æ–·æ¨¡å¼çš„å¯¦é©—ã€‚</p>
            </div>
            <div class="flex-grow flex flex-col gap-4 overflow-y-auto no-scrollbar pb-8">
                <div id="btn-cat-work" class="category-card bg-gray-50 border-2 border-gray-100 rounded-3xl p-6 flex items-center gap-4 cursor-pointer active:bg-gray-200 transition-all">
                    <div class="text-5xl">ğŸ¢</div>
                    <div><h3 class="text-2xl font-bold text-gray-900">è·å ´æ±‚ç”Ÿ</h3><p class="text-gray-500 text-base">ä½ æ˜¯æ‚²è§€æ´¾é‚„æ˜¯è·å ´è§€å¯Ÿå®¶ï¼Ÿ</p></div>
                </div>
                <div id="btn-cat-invest" class="category-card bg-orange-50 border-2 border-orange-100 rounded-3xl p-6 flex items-center gap-4 cursor-pointer active:bg-orange-100 transition-all">
                    <div class="text-5xl">ğŸ’°</div>
                    <div><h3 class="text-2xl font-bold text-gray-900">è²¡å¯Œå¯†ç¢¼</h3><p class="text-gray-500 text-base">ä½ çš„è²¡å•†æ˜¯é †å‹¢é‚„æ˜¯é€†å‹¢ï¼Ÿ</p></div>
                </div>
                <div id="btn-cat-life" class="category-card bg-green-50 border-2 border-green-100 rounded-3xl p-6 flex items-center gap-4 cursor-pointer active:bg-green-100 transition-all">
                    <div class="text-5xl">ğŸ€</div>
                    <div><h3 class="text-2xl font-bold text-gray-900">å‘½é‹è¼ªç›¤</h3><p class="text-gray-500 text-base">ä½ çš„ç›´è¦ºæœƒæŠ¼å°æ©Ÿç‡å—ï¼Ÿ</p></div>
                </div>
            </div>
            <div class="text-center mt-2 mb-4 flex-shrink-0">
                <p class="text-xs text-gray-500 font-bold flex items-center justify-center gap-2">
                    <span class="relative flex h-3 w-3">
                      <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-emerald-400 opacity-75"></span>
                      <span class="relative inline-flex rounded-full h-3 w-3 bg-emerald-500"></span>
                    </span>
                    ç³»çµ±é€£ç·šæ­£å¸¸ | æ•¸æ“šæºï¼šPolymarket
                </p>
            </div>
        </div>
    `;
}

function ViewLoading(state) {
    return `<div class="flex flex-col items-center justify-center h-full space-y-6 bg-gray-50 px-8 rounded-[2.5rem]"><div class="relative"><div class="w-20 h-20 border-[6px] border-gray-200 border-t-indigo-600 rounded-full animate-spin"></div></div><p class="text-gray-600 text-xl animate-pulse tracking-wide font-bold text-center">${state.loadingText}</p></div>`;
}

function ViewGame(state) {
    const q = state.questions[state.currentQIndex];
    const progress = ((state.currentQIndex + 1) / state.questions.length) * 100;
    
    return `
        <div class="flex flex-col h-full bg-gray-50 fade-in relative overflow-hidden">
            <div class="w-full h-2 bg-gray-200 flex-shrink-0"><div class="h-full bg-indigo-600 transition-all duration-500 ease-out" style="width: ${progress}%"></div></div>
            <div class="px-6 pt-6 flex justify-between items-center flex-shrink-0">
                <span class="text-gray-500 text-sm font-bold tracking-widest uppercase">Q ${state.currentQIndex + 1} / ${state.questions.length}</span>
                <span class="text-indigo-600 text-sm font-bold bg-indigo-100 px-3 py-1 rounded-full border border-indigo-200">${q.categoryLabel}</span>
            </div>
            
            <div class="px-6 py-4 flex-shrink-0">
                <div class="bg-white rounded-[2rem] p-6 shadow-sm border border-gray-100 slide-in-right mb-6">
                    <h2 class="text-2xl font-black text-gray-900 mb-3 leading-tight">${q.displayTitle}</h2>
                    <p class="text-gray-600 text-lg leading-relaxed font-medium">${q.introText}</p>
                </div>
            </div>

            <div class="flex-grow flex flex-col justify-center items-center relative overflow-y-auto no-scrollbar py-2">
                <div class="absolute text-[10rem] font-black text-gray-200 select-none -z-10 opacity-30 transform -rotate-12">%</div>
                
                <div class="text-center w-full max-w-xs relative z-10 my-auto pb-4">
                    <div class="h-4 w-full"></div> 
                    
                    <div class="mb-4 pulse-text flex justify-center items-center text-indigo-600 font-bold bg-indigo-100 inline-block px-5 py-2 rounded-full text-lg mx-auto shadow-sm">
                        <span>ğŸ‘‡ å·¦å³æ»‘å‹•è¼¸å…¥ç›´è¦º</span>
                    </div>
                    
                    <div id="val-display" class="text-6xl font-black text-indigo-600 tracking-tighter mb-6 tabular-nums relative inline-block drop-shadow-sm">
                        ${state.userGuess}<span class="text-3xl text-indigo-300 ml-1">%</span>
                    </div>
                    
                    <div class="relative h-28 w-full flex items-center py-4">
                        <div class="absolute left-0 right-0 top-1/2 h-6 bg-gray-200 rounded-full overflow-hidden transform -translate-y-1/2 pointer-events-none shadow-inner border border-gray-300">
                            <div id="track-fill" class="h-full bg-indigo-500 transition-all duration-150" style="width: ${state.userGuess}%"></div>
                        </div>
                        <input id="guess-slider" type="range" min="0" max="100" value="${state.userGuess}" class="z-10 relative w-full h-full opacity-0 cursor-pointer">
                        <div id="thumb-visual" class="absolute top-1/2 h-14 w-14 bg-white border-[6px] border-indigo-600 rounded-full shadow-[0_4px_16px_rgba(79,70,229,0.5)] transform -translate-y-1/2 -translate-x-1/2 pointer-events-none transition-all duration-150 flex items-center justify-center" style="left: ${state.userGuess}%">
                            <div class="w-4 h-4 bg-indigo-600 rounded-full"></div>
                        </div>
                    </div>
                    <div class="flex justify-between text-base font-bold text-gray-400 mt-2 px-2">
                        <span>0% ä¸å¯èƒ½</span><span>100% çµ•å°æœƒ</span>
                    </div>
                </div>
            </div>
            
            <div class="p-4 pt-4 bg-gray-50 border-t border-gray-200 flex-shrink-0 z-20">
                <button id="btn-confirm" class="w-full bg-gray-900 text-white text-2xl font-bold py-5 rounded-[2rem] shadow-xl transform transition active:scale-[0.98] hover:bg-gray-800 flex justify-center items-center gap-3 active:shadow-md">
                    ç¢ºèªé–å®š <span class="text-xl opacity-60">ğŸ”’</span>
                </button>
            </div>
        </div>
    `;
}

function ViewReveal(state) {
    const lastRecord = state.history[state.history.length - 1];
    const q = lastRecord.question;
    const userVal = lastRecord.user;
    const marketVal = lastRecord.market;
    let diffText = Math.abs(diff = userVal - marketVal) < 10 ? "è‹±é›„æ‰€è¦‹ç•¥åŒ" : (diff > 0 ? "ä½ æ¯”å¸‚å ´æ›´æ¨‚è§€" : "ä½ æ¯”å¸‚å ´æ›´ä¿å®ˆ");
    const diffColorClass = diff > 0 ? "text-orange-400" : "text-blue-400";
    const diffBgClass = diff > 0 ? "bg-orange-500" : "bg-blue-500";
    
    let marketComment = "";
    if(marketVal > 80) marketComment = "ğŸ”¥ å¸‚å ´å¹¾ä¹ä¸€é¢å€’";
    else if(marketVal > 60) marketComment = "ğŸ“ˆ å¸‚å ´åå‘æ¨‚è§€";
    else if(marketVal >= 40) marketComment = "âš–ï¸ å¸‚å ´é™·å…¥è† è‘—";
    else if(marketVal >= 20) marketComment = "ğŸ›¡ï¸ å¸‚å ´åå‘ä¿å®ˆ";
    else marketComment = "ğŸ§Š å¸‚å ´èªç‚ºæ¥µä¸å¯èƒ½";

    return `
        <div class="flex flex-col h-full bg-gray-900 text-white slide-up relative overflow-hidden">
            <div class="absolute top-0 right-0 w-80 h-80 bg-indigo-600 rounded-full mix-blend-multiply filter blur-3xl opacity-25 -mr-20 -mt-20 animate-pulse"></div>
            
            <div class="flex-grow overflow-y-auto px-8 pt-10 pb-36 scroll-smooth no-scrollbar relative z-10">
                <h3 class="text-indigo-400 text-sm font-bold uppercase tracking-widest mb-3">${q.categoryLabel}</h3>
                <h2 class="text-2xl font-black mb-12 leading-tight text-white/95">${q.displayTitle}</h2>
                <div class="space-y-12">
                    <div>
                        <div class="flex justify-between items-end mb-4"><span class="text-xl text-indigo-300 font-bold">ä½ çš„ç›´è¦º</span><span class="text-6xl font-black text-white leading-none tracking-tighter">${userVal}%</span></div>
                        <div class="h-5 bg-gray-800/50 rounded-full overflow-hidden border border-gray-700/50"><div class="h-full bg-indigo-500 rounded-full transition-all duration-1000 ease-out shadow-[0_0_12px_rgba(99,102,241,0.6)]" style="width: ${userVal}%"></div></div>
                    </div>
                    <div>
                        <div class="flex justify-between items-end mb-4">
                            <div class="flex flex-col gap-1">
                                <div class="flex items-center gap-2"><span class="text-xl text-emerald-300 font-bold">å¸‚å ´å…±è­˜</span><span class="text-[10px] text-gray-500 border border-gray-700 px-1.5 py-0.5 rounded bg-gray-800/50 tracking-wider">å³æ™‚æ•¸æ“š</span></div>
                                <span class="text-xl font-bold text-gray-100 tracking-wide drop-shadow-md">${marketComment}</span>
                            </div>
                            <span class="text-6xl font-black text-emerald-400 leading-none tracking-tighter">${marketVal}%</span>
                        </div>
                        <div class="h-5 bg-gray-800/50 rounded-full overflow-hidden border border-gray-700/50"><div class="h-full bg-emerald-500 rounded-full transition-all duration-1000 ease-out shadow-[0_0_12px_rgba(52,211,153,0.6)]" style="width: ${marketVal}%"></div></div>
                    </div>
                </div>
                <div class="mt-16 text-center">
                    <div class="inline-block px-8 py-6 bg-gray-800/60 backdrop-blur-md border border-gray-700/50 rounded-3xl shadow-2xl">
                        <span class="text-3xl font-black text-gray-100 block mb-2">${diffText}</span>
                        <span class="text-xl ${diffColorClass} font-bold tracking-wider flex items-center justify-center gap-2"><span class="inline-block w-3 h-3 rounded-full ${diffBgClass}"></span>å·®ç•° ${diff > 0 ? '+' : ''}${diff}%</span>
                    </div>
                </div>
            </div>
            
            <div class="p-4 pt-4 bg-gray-900 border-t border-gray-800 flex-shrink-0 z-20">
                <button id="btn-next" class="w-full bg-white text-gray-900 text-2xl font-bold py-5 rounded-[2rem] shadow-xl transform transition active:scale-[0.98] hover:bg-gray-200 active:shadow-md">ä¸‹ä¸€é¡Œ â†’</button>
            </div>
        </div>
    `;
}

// v6.1: æ›´æ–° ICI åˆ¤å®šå€é–“èˆ‡æ–‡æ¡ˆ
function ViewResult(state) {
    const totalDiff = state.history.reduce((acc, curr) => acc + curr.diff, 0);
    const avgDiff = totalDiff / state.history.length;
    const totalAbsDiff = state.history.reduce((acc, curr) => acc + Math.abs(curr.diff), 0);
    const avgAbsDiff = totalAbsDiff / state.history.length;
    
    // ICI è¨ˆç®—
    const ICI = Math.round(avgAbsDiff); 
    
    const biasValue = avgDiff > 0 ? `æ¯”å¤§çœ¾æ¨‚è§€ ${Math.round(avgDiff)}%` : (avgDiff < 0 ? `æ¯”å¤§çœ¾ä¿å®ˆ ${Math.round(Math.abs(avgDiff))}%` : "èˆ‡å¤§çœ¾å®Œå…¨ä¸€è‡´");
    let volValue = "";
    
    // v6.1: ICI é¡¯ç¤ºæ–‡æ¡ˆå°æ‡‰
    if (ICI >= 75) volValue = `${ICI} (æ¥µåº¦å·®ç•°)`;
    else if (ICI >= 55) volValue = `${ICI} (é«˜åº¦å·®ç•°)`;
    else if (ICI >= 35) volValue = `${ICI} (ä¸­åº¦å·®ç•°)`;
    else if (ICI >= 15) volValue = `${ICI} (ä½åº¦å·®ç•°)`;
    else volValue = `${ICI} (é«˜åº¦è²¼åˆ)`;

    let persona = {};
    // v6.1: å¯¦è£éç­‰è·å€é–“é‚è¼¯
    if (ICI >= 75) { 
        persona = { img: "https://api.dicebear.com/9.x/notionists/svg?seed=Magic&backgroundColor=f3e8ff", title: "ç›´è¦ºç¨è¡Œä¿ ", titleEn: "Instinct Maverick", color: "text-purple-600", tag: "æ¥µåº¦åå‘", desc: "ä½ ç¶“å¸¸åšå‡ºèˆ‡å¤šæ•¸äººä¸åŒçš„åˆ¤æ–·ï¼Œå‚¾å‘ç›¸ä¿¡è‡ªå·±çš„è§€å¯Ÿèˆ‡é‚è¼¯ã€‚", advice: "ğŸ’¡ <b>æ ¡æº–æé†’ï¼š</b>æˆ‘æ˜¯çœ‹åˆ°åˆ¥äººæ²’çœ‹åˆ°çš„ï¼Œé‚„æ˜¯åªæ˜¯é‚„æ²’æº–å‚™å¥½è·Ÿä¸Šï¼Ÿ" };
    } else if (ICI >= 55) { 
        persona = { img: "https://api.dicebear.com/9.x/notionists/svg?seed=Rocket&backgroundColor=ffedd5", title: "è§€é»å…ˆé‹’è€…", titleEn: "Perspective Explorer", color: "text-orange-500", tag: "é«˜åº¦å·®ç•°", desc: "ä½ ä¸ç¸½æ˜¯è·Ÿå¸‚å ´ä¸€æ¨£ï¼Œä½†å·®ç•°é€šå¸¸æœ‰è·¡å¯å¾ªã€‚ä½ é¡˜æ„å˜—è©¦ä¸åŒè§€é»ã€‚", advice: "ğŸ’¡ <b>æ ¡æº–æé†’ï¼š</b>ä½ çš„ç¨ç‰¹è¦–è§’å¾ˆæœ‰åƒ¹å€¼ï¼Œè©¦è‘—æ‰¾åˆ°èƒ½è½æ‡‚ä½ é‚è¼¯çš„äººã€‚" };
    } else if (ICI >= 35) { 
        persona = { img: "https://api.dicebear.com/9.x/micah/svg?seed=Felix&backgroundColor=e0e7ff", title: "ç¾¤é«”èª¿ç¯€è€…", titleEn: "Crowd Moderator", color: "text-indigo-600", tag: "ä¸­åº¦å·®ç•°", desc: "ä½ çš„ç›´è¦ºä»‹æ–¼ã€Œç¨ç‰¹ã€èˆ‡ã€Œå¾çœ¾ã€ä¹‹é–“ï¼Œé€šå¸¸è½åœ¨ç¾¤é«”çš„ä¸­ä½æ•¸ã€‚", advice: "ğŸ’¡ <b>æ ¡æº–æé†’ï¼š</b>ä½ çš„ç©©å®šæ˜¯åœ˜éšŠåŸºçŸ³ï¼Œä½†åœ¨é—œéµæ™‚åˆ»å¯ä»¥è©¦è‘—æ›´å¤§è†½ä¸€é»ã€‚" };
    } else if (ICI >= 15) { 
        persona = { img: "https://api.dicebear.com/9.x/notionists/svg?seed=Shield&backgroundColor=ccfbf1", title: "ç©©å®šè§€æœ›è€…", titleEn: "Stable Observer", color: "text-teal-600", tag: "ä½åº¦å·®ç•°", desc: "ä½ åå‘å…ˆè§€å¯Ÿå†åˆ¤æ–·ï¼Œå¤šæ•¸é¸æ“‡é è¿‘ä¸­é–“å€¼ï¼Œé¿å…æ¥µç«¯åˆ¤æ–·ã€‚", advice: "ğŸ’¡ <b>æ ¡æº–æé†’ï¼š</b>è§€æœ›æ˜¯å¥½äº‹ï¼Œä½†åˆ¥è®“å®ƒè®ŠæˆçŒ¶è±«ä¸æ±ºã€‚" };
    } else {
        persona = { img: "https://api.dicebear.com/9.x/micah/svg?seed=Felix&backgroundColor=e0e7ff", title: "å®‰å…¨å…±è­˜è€…", titleEn: "Safe Consensus", color: "text-blue-600", tag: "é«˜åº¦è²¼åˆ", desc: "ä½ çš„åˆ¤æ–·é«˜åº¦è²¼è¿‘ç¾¤é«”ï¼Œå¹¾ä¹èˆ‡å¸‚å ´è¶¨å‹¢ä¸€è‡´ã€‚", advice: "ğŸ’¡ <b>æ ¡æº–æé†’ï¼š</b>ä½ æ˜¯å¸‚å ´çš„é¢¨å‘çƒï¼Œèƒ½æ•éŠ³æ•æ‰åˆ°å¤§çœ¾ç¾åœ¨åœ¨æƒ³ä»€éº¼ã€‚" };
    }

    let biasComment = "";
    if (avgDiff > 10) biasComment = "åœ¨æ¨¡ç³Šå±€å‹¢ä¸­ï¼Œä½ å‚¾å‘çœ‹è¦‹ã€Œæ©Ÿæœƒã€è€Œéé¢¨éšªã€‚";
    else if (avgDiff < -10) biasComment = "åœ¨æ¨¡ç³Šå±€å‹¢ä¸­ï¼Œä½ å‚¾å‘çœ‹è¦‹ã€Œé¢¨éšªã€èˆ‡éš±æ†‚ã€‚";
    else biasComment = "ä½ çš„ç›´è¦ºèˆ‡ç¾¤é«”å…±è­˜é«˜åº¦åŒæ­¥ã€‚";

    return `
        <div class="flex flex-col h-full bg-white relative fade-in overflow-hidden">
            <div class="flex-grow overflow-y-auto px-6 pt-6 pb-72 scroll-smooth no-scrollbar relative z-10">
                <div class="text-center">
                    <p class="text-gray-400 text-sm font-bold tracking-[0.3em] uppercase mb-4">ä½ çš„ç›´è¦ºæ ¡æº–çµæœ</p>
                    
                    <div class="mb-8">
                        <span class="inline-block px-4 py-1.5 bg-indigo-50 text-indigo-600 text-xs font-bold tracking-wider rounded-full mb-3 uppercase">ä½ çš„ç›´è¦ºé¡å‹</span>
                        <h2 class="text-5xl font-black mb-1 text-gray-900 leading-tight tracking-tight">${persona.title}</h2>
                        <p class="text-gray-400 text-sm font-bold uppercase tracking-widest opacity-80">${persona.titleEn}</p>
                    </div>

                    <div class="bg-gray-50 rounded-3xl p-6 mb-8 text-left border border-gray-100">
                        <h4 class="text-sm font-bold text-gray-400 mb-2">ç‚ºä»€éº¼ä½ æ˜¯é€™ä¸€å‹ï¼Ÿ</h4>
                        <p class="text-gray-700 text-lg leading-relaxed font-medium">${persona.desc}</p>
                    </div>

                    <div class="mb-10">
                        <div class="flex justify-between items-end mb-2 px-2">
                            <span class="text-4xl font-black text-gray-900">ICI ${ICI}</span>
                            <span class="text-sm text-gray-500 font-bold bg-gray-100 px-2 py-1 rounded">å·®ç•°æŒ‡æ•¸ 0-100</span>
                        </div>
                        <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                            <div class="bg-indigo-600 h-4 rounded-full" style="width: ${Math.min(ICI, 100)}%"></div>
                        </div>
                        <p class="text-xs text-gray-400 mt-2 text-left px-1">é€™ä¸æ˜¯åˆ†æ•¸ï¼Œè€Œæ˜¯ä½ èˆ‡å¤šæ•¸äººåˆ¤æ–·çš„ã€Œè·é›¢ã€ã€‚</p>
                    </div>

                    <div class="space-y-6 text-left">
                        <div class="bg-indigo-50 p-6 rounded-2xl border-l-4 border-indigo-500">
                            <p class="text-indigo-800 leading-relaxed">${persona.advice}</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="absolute bottom-0 left-0 right-0 z-20 pointer-events-none">
                <div class="h-48 bg-gradient-to-t from-white via-white/98 to-transparent flex flex-col justify-end items-center p-6 pb-12">
                    <button id="btn-restart" class="w-full bg-gray-900 text-white text-2xl font-bold py-6 rounded-[2rem] shadow-xl transform transition active:scale-[0.98] hover:bg-gray-800 pointer-events-auto active:shadow-lg">
                        æ›å€‹æƒ…å¢ƒå†æ¸¬ä¸€æ¬¡
                    </button>
                </div>
            </div>
        </div>
    `;
}

store.subscribe(render);
render(store.state);
</script>
</body>
</html>